% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/01_impute.R
\name{linear_impute}
\alias{linear_impute}
\title{Second Stage Model Linear Regression at Anchor Time Points}
\usage{
linear_impute(
  lm_formula,
  data_impute,
  data_test,
  id_var,
  outcome_var,
  time_var,
  anchor_time,
  ...
)
}
\arguments{
\item{lm_formula}{\code{formula}. A user-defined linear regression formula for the second-stage imputation. The formula can optionally include additional time-invariant covariates and baseline outcomes.}

\item{data_impute}{\code{data.frame}. The training dataset used to fit the linear regression model, based on the anchor time points.}

\item{data_test}{\code{data.frame}. The testing dataset for which missing values are imputed using the linear regression model.}

\item{id_var}{\code{character}. The name of the ID variable in the dataset.}

\item{outcome_var}{\code{character}. The name of the outcome variable in the dataset.}

\item{time_var}{\code{character}. The name of the time variable in the dataset.}

\item{anchor_time}{\code{numeric}. The anchor time point(s) at which imputation is performed.}

\item{...}{Additional arguments, currently not used but included for future extensions.}
}
\value{
A list containing:
\describe{
\item{\code{testing}}{\code{data.frame}. The testing dataset with imputed values at the anchor time points.}
\item{\code{training}}{\code{data.frame}. The training dataset with imputed values at the anchor time points.}
\item{\code{summary}}{\code{summary.lm}. A summary of the fitted linear regression model.}
}
}
\description{
This function performs a second-stage imputation using linear regression at anchor time points, after the first-stage imputation with the brokenstick model. It takes the imputed outcomes from the brokenstick model and performs imputation for missing values at anchor time points using a linear regression model. The model can include time-invariant covariates and baseline outcomes, possibly with interaction terms. This function is primarily called within the \code{people_like_i()} function for single time point matching.
}
\examples{
\dontrun{
# Example usage
# Prepare sample data
data_impute <- data.frame(
  id = rep(1:10, each = 5),
  time = rep(seq(0, 10, by = 2.5), 10),
  outcome = rnorm(50),
  covariate = runif(50)
)
data_test <- data_impute

# Define parameters
lm_formula <- "outcome ~ time + covariate"
id_var <- "id"
outcome_var <- "outcome"
time_var <- "time"
anchor_time <- 5

# Call the linear_impute function
result <- linear_impute(
  lm_formula = lm_formula,
  data_impute = data_impute,
  data_test = data_test,
  id_var = id_var,
  outcome_var = outcome_var,
  time_var = time_var,
  anchor_time = anchor_time
)

# Inspect the results
head(result$testing)  # Testing dataset with imputed values
head(result$training) # Training dataset with imputed values
print(result$summary) # Summary of the linear regression model
}
}
